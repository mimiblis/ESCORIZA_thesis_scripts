##R version 3.2.1##
###################
#this script is used to make histograms with the nb of peaks from the annotation
#################################################################################

#make matrices of nb of peaks on forward and reverse strand
prod.coding.hum <- matrix(c(9268, 9108,
10720, 10446),
nrow=2, ncol=2)


prod.coding.mac <- matrix(c(10886, 10771,
15313, 14924),
nrow=2, ncol=2)


#give row and col names (Forw_rev1 = Forward, Forw_rev2 = Reverse)
colnames(prod.coding.hum) <- c('Young_Human', 'Old_Human')
rownames(prod.coding.hum) <- c('Forward_Strand', 'Reverse_Strand')

colnames(prod.coding.mac) <- c('Young_Macaque', 'Old_Macaque')
rownames(prod.coding.mac) <- c('Forward_Strand', 'Reverse_Strand')

pdf('histograms_forward_reverse.pdf', 15, 10)
par(mfrow=c(1, 2))

#make barplots
barplot(prod.coding.hum, beside = TRUE, col=c('red', 'blue'), legend = c('forward strand', 'reverse strand'), 
 main = 'Number of Peaks per individual on forward or reverse strand', 
 xlab = 'Individual', 
 ylab= 'Nb of peaks',
 ylim = c(0,18000))

barplot(prod.coding.mac, beside = TRUE, col=c('red', 'blue'), legend = c('forward strand', 'reverse strand'), 
 main = 'Number of Peaks per individual on forward or reverse strand', 
 xlab = 'Individual', 
 ylab= 'Nb of peaks',
 ylim = c(0,18000))

dev.off()

chr.upstream <- matrix(c(
3.926441352, 6.212723658, 5.914512922, 4.373757455, 12.01793722, 16.8161435, 16.4573991,
2.992518703, 4.821280133, 4.571903574, 3.740648379, 6.25, 11.16071429, 9.017857143,
4.038461538, 5, 4.326923077, 3.846153846, 8.02238806, 13.5261194, 11.28731343,
1.810584958, 3.064066852, 1.810584958, 1.253481894, 8.632478632, 11.11111111, 12.05128205,
4.122497055, 5.300353357, 5.064782097, 3.769140165, 3.684879288, 4.066073698, 4.447268107,
6.586826347, 7.48502994, 7.584830339, 6.886227545, 3.987408185, 7.974816369, 7.135362015,
3.926096998, 5.19630485, 4.965357968, 4.272517321, 10.08708273, 15.02177068, 14.00580552,
4.097116844, 6.069802731, 5.766312595, 4.704097117, 4.644808743, 9.699453552, 9.972677596,
4.840764331, 7.261146497, 6.242038217, 4.331210191, 6.95754717, 9.905660377, 10.37735849,
3.489932886, 4.295302013, 4.026845638, 3.355704698, 14.39466158, 22.11630124, 18.11248808,
4.13354531, 5.564387917, 4.769475358, 4.054054054, 10.2233677, 15.03436426, 14.604811,
5.782652044, 6.380857428, 6.28115653, 5.982053838, 6.075533662, 9.688013136, 10.67323481,
3.144654088, 3.773584906, 3.773584906, 2.51572327, 9.913258984, 13.01115242, 10.78066914,
4.991680532, 6.322795341, 6.988352745, 5.657237937, 11.05058366, 17.12062257, 16.18677043,
4.448398577, 5.338078292, 4.448398577, 4.270462633, 12.1749409, 19.03073286, 20.56737589,
6.086956522, 11.30434783, 8.695652174, 7.453416149, 16.85789938, 24.44836717, 21.00617829,
5.872193437, 7.25388601, 7.081174439, 6.044905009, 7.03125, 11.19791667, 9.895833333,
1.492537313, 2.611940299, 2.23880597, 2.23880597, 6.5830721, 8.777429467, 8.777429467,
10.79342387, 14.58184417, 12.29449607, 11.15082202, 22.90881688, 36.24717408, 33.98643557,
1.876172608, 6.191369606, 4.502814259, 2.814258912, 21.04046243, 30.28901734, 28.09248555,
1.333333333, 2.666666667, 2.222222222, 1.777777778, 0, 0, 0,
6.26450116, 10.67285383, 9.048723898, 6.960556845, 0, 0, 0),
ncol=22, nrow=7)

dimnames(chr.upstream) <- list(rownames(chr.upstream, do.NULL = FALSE, prefix = NULL),
 colnames(chr.upstream, do.NULL = FALSE, prefix = 'chr'))

chr.downstream <- matrix(c(
10.28827038, 14.21471173, 13.71769384, 11.18290258, 10.67264574, 14.84304933, 14.88789238,
7.315045719, 8.728179551, 8.146300914, 7.564422278, 5.982142857, 10.17857143, 9.642857143,
8.461538462, 11.05769231, 10.28846154, 8.942307692, 8.302238806, 13.43283582, 11.28731343,
4.038997214, 5.292479109, 4.317548747, 4.038997214, 7.35042735, 11.96581197, 12.99145299,
6.478209658, 8.598351001, 8.716136631, 6.713780919, 3.557814485, 4.701397713, 4.066073698,
9.081836327, 10.27944112, 11.07784431, 10.57884232, 5.456453305, 9.44386149, 7.345225603,
5.542725173, 9.468822171, 8.429561201, 6.351039261, 9.869375907, 14.22351234, 13.13497823,
7.132018209, 8.952959029, 9.104704097, 7.435508346, 6.147540984, 9.016393443, 10.38251366,
11.97452229, 15.54140127, 14.52229299, 12.7388535, 6.839622642, 10.37735849, 10.49528302,
7.248322148, 10.46979866, 9.127516779, 8.322147651, 15.63393708, 25.4528122, 21.06768351,
10.09538951, 13.354531, 13.11605723, 12.40063593, 10.99656357, 15.54982818, 14.00343643,
10.66799601, 13.75872383, 11.36590229, 10.16949153, 6.896551724, 10.34482759, 11.65845649,
2.830188679, 4.716981132, 4.088050314, 3.459119497, 6.567534077, 11.64807931, 10.65675341,
8.818635607, 12.81198003, 10.48252912, 9.816971714, 13.15175097, 18.13229572, 17.82101167,
8.362989324, 11.03202847, 9.964412811, 9.252669039, 12.1749409, 19.03073286, 17.25768322,
16.02484472, 22.48447205, 17.76397516, 16.39751553, 16.50485437, 24.36010591, 20.91791703,
14.42141623, 19.43005181, 17.44386874, 16.06217617, 5.46875, 9.895833333, 10.67708333,
2.611940299, 2.985074627, 2.985074627, 2.611940299, 5.956112853, 11.91222571, 11.59874608,
17.72694782, 24.08863474, 21.65832738, 19.65689778, 23.43632253, 37.07611153, 33.08214017,
11.25703565, 15.94746717, 13.32082552, 11.25703565, 20.80924855, 34.56647399, 30.98265896,
4.444444444, 5.777777778, 5.777777778, 4.444444444, 0, 0, 0,
14.38515081, 17.86542923, 16.00928074, 12.76102088, 0, 0, 0),
ncol=22, nrow=7)

dimnames(chr.downstream) <- list(rownames(chr.downstream, do.NULL = FALSE, prefix = NULL),
 colnames(chr.downstream, do.NULL = FALSE, prefix = 'chr'))

chr.ovSt <- matrix(c(
55.11928429, 56.85884692, 56.4612326, 53.18091451, 10.71748879, 7.668161435, 7.219730942,
62.75976725, 64.75477972, 64.83790524, 61.42975894, 6.339285714, 5, 5.178571429,
61.82692308, 62.88461538, 62.88461538, 60.48076923, 6.529850746, 6.529850746, 6.156716418,
63.9275766, 65.73816156, 64.48467967, 62.81337047, 6.239316239, 4.871794872, 5.641025641,
63.72202591, 67.25559482, 66.54888104, 63.36866902, 3.811944091, 2.287166455, 2.414231258,
59.58083832, 62.4750499, 61.77644711, 58.28343313, 3.777544596, 3.357817419, 2.518363064,
58.19861432, 59.93071594, 58.54503464, 57.04387991, 9.724238026, 7.619738752, 7.619738752,
62.97420334, 64.64339909, 64.03641882, 62.6707132, 6.010928962, 5.87431694, 4.371584699,
61.52866242, 62.03821656, 62.1656051, 60.63694268, 5.188679245, 4.009433962, 4.363207547,
60.80536913, 63.3557047, 62.95302013, 60.26845638, 15.44327931, 12.20209724, 11.05815062,
50.15898251, 53.33863275, 52.78219396, 51.82829889, 9.621993127, 9.965635739, 8.075601375,
60.01994018, 60.41874377, 60.31904287, 57.82652044, 6.239737274, 4.597701149, 6.732348112,
66.03773585, 67.61006289, 67.9245283, 64.77987421, 5.94795539, 5.700123916, 6.567534077,
65.22462562, 66.55574043, 65.72379368, 65.39101498, 11.28404669, 8.715953307, 8.093385214,
66.5480427, 67.79359431, 67.97153025, 65.83629893, 12.29314421, 10.40189125, 10.40189125,
61.49068323, 64.59627329, 63.47826087, 62.11180124, 14.38658429, 12.62135922, 10.5913504,
55.35405872, 58.46286701, 57.68566494, 55.69948187, 6.25, 4.427083333, 4.166666667,
68.28358209, 69.40298507, 69.02985075, 67.91044776, 3.134796238, 2.194357367, 2.194357367,
56.32594711, 58.25589707, 57.54110079, 55.61115082, 20.49736247, 19.36699322, 17.70911831,
59.28705441, 60.97560976, 60.60037523, 59.09943715, 18.84393064, 17.91907514, 15.95375723,
48.88888889, 51.55555556, 49.77777778, 46.22222222, 0, 0, 0,
59.16473318, 61.02088167, 61.25290023, 57.54060325, 0, 0, 0),
ncol=22, nrow=7)

dimnames(chr.ovSt) <- list(rownames(chr.ovSt, do.NULL = FALSE, prefix = NULL),
 colnames(chr.ovSt, do.NULL = FALSE, prefix = 'chr'))

chr.ovEnd <- matrix(c(
3.230616302, 3.081510934, 2.186878728, 1.640159046, 11.52466368, 8.475336323, 8.789237668,
1.74563591, 2.826267664, 2.078137988, 1.413133832, 6.696428571, 6.25, 4.642857143,
3.365384615, 3.557692308, 2.403846154, 1.923076923, 5.037313433, 4.47761194, 4.850746269,
0.69637883, 1.949860724, 0.835654596, 0.557103064, 7.435897436, 5.128205128, 5.897435897,
2.002355713, 3.886925795, 2.002355713, 1.648998822, 2.668360864, 2.033036849, 2.287166455,
3.592814371, 3.992015968, 2.49500998, 1.896207585, 5.141657922, 3.672612802, 4.197271773,
1.847575058, 3.002309469, 1.847575058, 0.808314088, 9.216255443, 6.168359942, 6.240928882,
2.276176024, 3.186646434, 2.427921093, 1.517450683, 6.147540984, 5.054644809, 5.054644809,
3.821656051, 4.331210191, 3.184713376, 1.78343949, 6.95754717, 4.481132075, 5.070754717,
1.610738255, 1.744966443, 1.073825503, 0.805369128, 15.25262154, 13.53670162, 12.01143947,
3.895071542, 6.120826709, 3.73608903, 2.464228935, 10.13745704, 7.302405498, 8.333333333,
2.991026919, 2.492522433, 2.093718843, 1.49551346, 7.717569787, 6.568144499, 6.732348112,
2.51572327, 1.572327044, 1.257861635, 1.257861635, 5.94795539, 4.58488228, 5.452292441,
1.996672213, 2.495840266, 1.996672213, 1.164725458, 11.90661479, 9.883268482, 10.27237354,
1.779359431, 2.669039146, 2.135231317, 1.245551601, 10.63829787, 10.52009456, 9.338061466,
6.583850932, 8.447204969, 6.211180124, 3.726708075, 13.68049426, 11.9152692, 12.18005296,
6.131260794, 5.958549223, 5.008635579, 2.763385147, 4.6875, 3.125, 3.125,
0.746268657, 1.119402985, 0.746268657, 0.373134328, 3.761755486, 2.194357367, 4.07523511,
7.719799857, 9.149392423, 6.004288778, 4.360257327, 19.51770912, 18.01055011, 15.5990957,
2.43902439, 6.566604128, 3.377110694, 3.939962477, 20.80924855, 18.38150289, 17.80346821,
1.777777778, 2.222222222, 1.777777778, 1.333333333, 0, 0, 0,
4.408352668, 7.88863109, 3.944315545, 2.784222738, 0, 0, 0
),
ncol=22, nrow=7)

dimnames(chr.ovEnd) <- list(rownames(chr.ovEnd, do.NULL = FALSE, prefix = NULL),
 colnames(chr.ovEnd, do.NULL = FALSE, prefix = 'chr'))

chr.include <- matrix(c(
1.540755467, 1.640159046, 1.143141153, 0.944333996, 2.825112108, 0.986547085, 1.34529148,
1.413133832, 1.662510391, 1.246882793, 0.831255195, 1.875, 0.892857143, 0.982142857,
1.25, 1.153846154, 0.673076923, 0.288461538, 1.399253731, 0.839552239, 0.932835821,
0.835654596, 0.417827298, 0.278551532, 0.139275766, 2.64957265, 1.538461538, 1.282051282,
1.295641932, 1.295641932, 0.942285041, 0.706713781, 0.127064803, 0.254129606, 0.254129606,
2.794411178, 2.395209581, 1.996007984, 1.596806387, 0.524658972, 0.524658972, 0.524658972,
1.154734411, 1.501154734, 1.270207852, 0.577367206, 1.669085631, 1.088534107, 1.161103048,
1.972685888, 2.579666161, 1.517450683, 0.606980273, 1.912568306, 1.366120219, 0.956284153,
1.656050955, 1.52866242, 1.78343949, 0.76433121, 1.886792453, 0.943396226, 1.061320755,
1.476510067, 1.342281879, 1.342281879, 1.208053691, 4.480457579, 2.85986654, 2.573879886,
2.464228935, 1.907790143, 1.589825119, 0.874403816, 2.06185567, 0.773195876, 0.945017182,
0.897308076, 0.997008973, 0.897308076, 0.398803589, 1.806239737, 0.492610837, 0.65681445,
0.628930818, 0.314465409, 0.314465409, 0.628930818, 1.486988848, 0.743494424, 0.619578686,
1.663893511, 1.663893511, 1.164725458, 0.499168053, 5.369649805, 2.568093385, 2.33463035,
0.711743772, 1.245551601, 0.533807829, 0.177935943, 4.137115839, 1.891252955, 1.773049645,
3.354037267, 3.229813665, 2.608695652, 1.49068323, 6.178287732, 3.177405119, 3.177405119,
2.331606218, 2.245250432, 1.640759931, 1.122625216, 0.520833333, 0.78125, 0.78125,
0.373134328, 0.373134328, 0, 0.373134328, 0.313479624, 0, 0,
3.002144389, 2.787705504, 2.430307362, 1.358112938, 7.987942728, 3.315749812, 3.240391861,
2.251407129, 2.814258912, 1.876172608, 0.750469043, 8.670520231, 4.739884393, 4.161849711,
0, 0, 0, 0.444444444, 0, 0, 0,
2.552204176, 2.552204176, 1.392111369, 1.392111369, 0, 0, 0),
ncol=22, nrow=7)

dimnames(chr.include) <- list(rownames(chr.include, do.NULL = FALSE, prefix = NULL),
 colnames(chr.include, do.NULL = FALSE, prefix = 'chr'))

chr.inside <- matrix(c(
16.94831014, 36.72962227, 28.47912525, 21.91848907, 64.88789238, 99.59641256, 96.68161435,
22.61014131, 42.22776392, 32.66832918, 28.0964256, 57.67857143, 87.14285714, 90.71428571,
27.30769231, 42.30769231, 36.34615385, 31.92307692, 59.04850746, 100.7462687, 95.24253731,
12.67409471, 27.57660167, 20.05571031, 15.1810585, 51.53846154, 81.1965812, 86.41025641,
13.54534747, 30.27090695, 23.91048292, 15.90106007, 36.84879288, 53.74841169, 55.65438374,
16.66666667, 27.04590818, 24.05189621, 19.66067864, 42.81217209, 70.409234, 76.70514166,
23.44110855, 47.22863741, 39.37644342, 28.29099307, 67.41654572, 104.3541364, 101.5965167,
14.26403642, 32.47344461, 25.49317147, 17.60242792, 48.08743169, 85.79234973, 87.29508197,
16.56050955, 43.31210191, 26.75159236, 19.23566879, 67.57075472, 106.7216981, 108.6084906,
20, 45.23489933, 31.54362416, 24.4295302, 74.73784557, 129.9332698, 116.0152526,
11.92368839, 29.9682035, 20.74721781, 14.22893482, 51.89003436, 90.54982818, 83.50515464,
12.56231306, 27.91625125, 18.24526421, 14.6560319, 61.57635468, 92.61083744, 98.85057471,
18.55345912, 38.05031447, 28.93081761, 19.49685535, 56.62949195, 91.57372986, 90.83023544,
11.81364393, 25.62396007, 19.30116473, 14.30948419, 61.40077821, 95.3307393, 91.75097276,
14.59074733, 32.91814947, 24.3772242, 16.90391459, 80.4964539, 137.5886525, 121.6312057,
11.67701863, 36.39751553, 25.46583851, 15.90062112, 79.08208297, 131.1562224, 116.5048544,
11.39896373, 32.12435233, 23.1433506, 16.14853195, 62.23958333, 100.2604167, 104.4270833,
13.80597015, 38.80597015, 29.10447761, 19.7761194, 53.29153605, 96.23824451, 100.9404389,
19.79985704, 42.88777698, 32.30879199, 23.15939957, 60.28636021, 104.2200452, 92.76563677,
17.44840525, 45.02814259, 32.45778612, 22.32645403, 92.25433526, 147.6300578, 141.6184971,
16.44444444, 36.88888889, 25.33333333, 20.44444444, 0, 0, 0,
39.21113689, 76.79814385, 52.90023202, 41.53132251, 0, 0, 0),
ncol=22, nrow=7)

dimnames(chr.inside) <- list(rownames(chr.inside, do.NULL = FALSE, prefix = NULL),
 colnames(chr.inside, do.NULL = FALSE, prefix = 'chr'))

pdf('histograms_perChromosome.pdf', 15, 18)
par(mfrow=c(2, 1))

barplot(chr.upstream, beside = TRUE, col=c('red', 'yellow', 'blue', 'pink', 'green', 'orange', 'blueviolet'),
 legend = c('hum1', 'hum2', 'hum3', 'hum4', 'mac1', 'mac2', 'mac3'), 
 main = 'Normalization of the number of peaks per chromosome', 
 ylab = 'Normalized number of peaks = "upstream"', 
 xlab= 'Chromosome',
 ylim = c(0,100))

barplot(chr.downstream, beside = TRUE, col=c('red', 'yellow', 'blue', 'pink', 'green', 'orange', 'blueviolet'),
 legend = c('hum1', 'hum2', 'hum3', 'hum4', 'mac1', 'mac2', 'mac3'), 
 main = 'Normalization of the number of peaks per chromosome', 
 ylab = 'Normalized number of peaks = "downstream"', 
 xlab= 'Chromosome',
 ylim = c(0,100))

barplot(chr.ovSt, beside = TRUE, col=c('red', 'yellow', 'blue', 'pink', 'green', 'orange', 'blueviolet'),
 legend = c('hum1', 'hum2', 'hum3', 'hum4', 'mac1', 'mac2', 'mac3'), 
 main = 'Normalization of the number of peaks per chromosome', 
 ylab = 'Normalized number of peaks = "overlapStart"', 
 xlab= 'Chromosome',
 ylim = c(0,100))

barplot(chr.ovEnd, beside = TRUE, col=c('red', 'yellow', 'blue', 'pink', 'green', 'orange', 'blueviolet'),
 legend = c('hum1', 'hum2', 'hum3', 'hum4', 'mac1', 'mac2', 'mac3'), 
 main = 'Normalization of the number of peaks per chromosome', 
 ylab = 'Normalized number of peaks = "overlapEnd"', 
 xlab= 'Chromosome',
 ylim = c(0,100))

barplot(chr.include, beside = TRUE, col=c('red', 'yellow', 'blue', 'pink', 'green', 'orange', 'blueviolet'),
 legend = c('hum1', 'hum2', 'hum3', 'hum4', 'mac1', 'mac2', 'mac3'), 
 main = 'Normalization of the number of peaks per chromosome', 
 ylab = 'Normalized number of peaks = "includeFeature"', 
 xlab= 'Chromosome',
 ylim = c(0,100))

barplot(chr.inside, beside = TRUE, col=c('red', 'yellow', 'blue', 'pink', 'green', 'orange', 'blueviolet'),
 legend = c('hum1', 'hum2', 'hum3', 'hum4', 'mac1', 'mac2', 'mac3'), 
 main = 'Normalization of the number of peaks per chromosome', 
 ylab = 'Normalized number of peaks = "insideFeature"', 
 xlab= 'Chromosome',
 ylim = c(0,100))

dev.off()


